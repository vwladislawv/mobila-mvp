---
import BaseLayout from "../layouts/BaseLayout.astro";

const projects = Array.from({ length: 12 }, (_, index) => {
  const id = index + 1;
  return {
    title: `Project ${id}`,
    description: "Custom millwork with warm oak, matte finishes, and integrated lighting.",
    image: `https://picsum.photos/seed/mobila-${id}/1200/800`
  };
});
---

<BaseLayout title="Portfolio" description="Explore a curated selection of bespoke furniture projects.">
  <section class="hero compact">
    <div class="hero-text">
      <p class="eyebrow">Portfolio</p>
      <h1>Spaces shaped by craftsmanship and calm.</h1>
      <p class="lede">
        A selection of our recent installations, from contemporary kitchens to sculptural media
        walls. Tap any project to see a larger view.
      </p>
    </div>
    <div class="hero-card">
      <div class="hero-image alt-two"></div>
      <div class="hero-card-body">
        <h3>Studio library</h3>
        <p>Each project is made-to-measure, with unique material palettes.</p>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="section-header">
      <h2>Featured work</h2>
      <p>12 recent projects showcasing our range of styles and finishes.</p>
    </div>
    <div class="portfolio-grid">
      {projects.map((project) => (
        <button
          class="project-card"
          type="button"
          data-lightbox
          data-title={project.title}
          data-description={project.description}
          data-image={project.image}
        >
          <div class="project-image" style={{ backgroundImage: `url(${project.image})` }}></div>
          <div class="project-meta">
            <h3>{project.title}</h3>
            <p>{project.description}</p>
          </div>
        </button>
      ))}
    </div>
  </section>

  <div id="lightbox" class="lightbox" aria-hidden="true">
    <div class="lightbox-content" role="dialog" aria-modal="true" aria-label="Project preview">
      <button class="lightbox-close" type="button">Close</button>
      <img id="lightbox-image" src="" alt="" />
      <div class="lightbox-caption">
        <h3 id="lightbox-title"></h3>
        <p id="lightbox-text"></p>
      </div>
    </div>
  </div>

  <script>
    const lightbox = document.getElementById("lightbox");
    const image = document.getElementById("lightbox-image");
    const title = document.getElementById("lightbox-title");
    const text = document.getElementById("lightbox-text");
    const closeButton = document.querySelector(".lightbox-close");
    const cards = document.querySelectorAll("[data-lightbox]");

    const openLightbox = (card) => {
      if (!lightbox || !image || !title || !text) return;
      image.src = card.dataset.image || "";
      image.alt = card.dataset.title || "Project preview";
      title.textContent = card.dataset.title || "";
      text.textContent = card.dataset.description || "";
      lightbox.classList.add("open");
      lightbox.setAttribute("aria-hidden", "false");
      document.body.classList.add("no-scroll");
    };

    const closeLightbox = () => {
      if (!lightbox) return;
      lightbox.classList.remove("open");
      lightbox.setAttribute("aria-hidden", "true");
      document.body.classList.remove("no-scroll");
    };

    cards.forEach((card) => {
      card.addEventListener("click", () => openLightbox(card));
    });

    lightbox?.addEventListener("click", (event) => {
      if (event.target === lightbox) {
        closeLightbox();
      }
    });

    closeButton?.addEventListener("click", closeLightbox);

    document.addEventListener("keydown", (event) => {
      if (event.key === "Escape") {
        closeLightbox();
      }
    });
  </script>
</BaseLayout>
